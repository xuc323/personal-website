steps:
  - name: gcr.io/cloud-builders/npm
    args:
      - ci
  - name: gcr.io/cloud-builders/npm
    env:
      - FIREBASE_CLI_EXPERIMENTS=webframeworks
      - NEXT_PUBLIC_API_KEY=$_NEXT_PUBLIC_API_KEY
      - NEXT_PUBLIC_AUTH_DOMAIN=$_NEXT_PUBLIC_AUTH_DOMAIN
      - NEXT_PUBLIC_PROJECT_ID=$_NEXT_PUBLIC_PROJECT_ID
      - NEXT_PUBLIC_STORAGE_BUCKET=$_NEXT_PUBLIC_STORAGE_BUCKET
      - NEXT_PUBLIC_MESSAGING_SENDER_ID=$_NEXT_PUBLIC_MESSAGING_SENDER_ID
      - NEXT_PUBLIC_APP_ID=$_NEXT_PUBLIC_APP_ID
      - NEXT_PUBLIC_MEASUREMENT_ID=$_NEXT_PUBLIC_MEASUREMENT_ID
      - NEXT_PUBLIC_APP_CHECK_ID=$_NEXT_PUBLIC_APP_CHECK_ID
    args:
      - firebase-tools@latest
      - deploy
      - "--project=$PROJECT_ID"
      - "--only=hosting"
    entrypoint: npx
